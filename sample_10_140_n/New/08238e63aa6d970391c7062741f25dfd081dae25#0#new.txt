[{"block": 0, "type": "markdown", "linesLength": 1, "startIndex": 0, "lines": ["# Widgets"]}, {"block": 1, "type": "code", "linesLength": 2, "startIndex": 1, "lines": ["%reload_ext autoreload\n", "%autoreload 2"]}, {"block": 2, "type": "code", "linesLength": 3, "startIndex": 3, "lines": ["from fastai import *\n", "from fastai.vision import *\n", "from fastai.widgets import DatasetFormatter, ImageCleaner"]}, {"block": 3, "type": "markdown", "linesLength": 1, "startIndex": 6, "lines": ["fastai offers several widgets to support the workflow of a deep learning practitioner. The purpose of the widgets are to help you organize, clean, and prepare your data for your model. Widgets are separated by data type."]}, {"block": 4, "type": "markdown", "linesLength": 1, "startIndex": 7, "lines": ["## Images"]}, {"block": 5, "type": "markdown", "linesLength": 2, "startIndex": 8, "lines": ["### DatasetFormatter\n", "The [`DatasetFormatter`](/widgets.image_cleaner.html#DatasetFormatter) class prepares your image dataset for widgets by returning a formatted [`DatasetTfm`](/vision.data.html#DatasetTfm) based on the [`DatasetType`](/basic_data.html#DatasetType) specified. Use `from_toplosses` to grab the most problematic images directly from your learner. Optionally, you can restrict the formatted dataset returned to `n_imgs`."]}, {"block": 6, "type": "code", "linesLength": 2, "startIndex": 10, "lines": ["path = untar_data(URLs.MNIST_SAMPLE)\n", "data = ImageDataBunch.from_folder(path)"]}, {"block": 7, "type": "code", "linesLength": 1, "startIndex": 12, "lines": ["learn = create_cnn(data, models.resnet18, metrics=error_rate)"]}, {"block": 8, "type": "code", "linesLength": 1, "startIndex": 13, "lines": ["learn.fit_one_cycle(2)"]}, {"block": 9, "type": "code", "linesLength": 1, "startIndex": 14, "lines": ["learn.save('stage-1')"]}, {"block": 10, "type": "code", "linesLength": 12, "startIndex": 15, "lines": ["# We create a databunch with all the data in the training set and no validation set (DatasetFormatter uses only the training set)\n", "np.random.seed(42)\n", "src_del = (ImageItemList.from_folder(path)\n", "                           .split_by_folder()\n", "                           .label_from_folder())\n", "\n", "items = ImageItemList([*src_del.train.x.items, *src_del.valid.x.items])\n", "cats = CategoryList([*src_del.train.y.items, *src_del.valid.y.items], data.classes)\n", "\n", "ll = LabelList(items, cats)\n", "\n", "db = LabelLists(path, ll, src_del.valid).databunch()"]}, {"block": 11, "type": "code", "linesLength": 2, "startIndex": 27, "lines": ["learn = create_cnn(db, models.resnet18, metrics=[accuracy])\n", "learn.load('stage-1')"]}, {"block": 12, "type": "markdown", "linesLength": 1, "startIndex": 29, "lines": ["### ImageCleaner"]}, {"block": 13, "type": "markdown", "linesLength": 1, "startIndex": 30, "lines": ["[`ImageCleaner`](/widgets.image_cleaner.html#ImageCleaner) is for cleaning up images that don't belong in your dataset. It renders images in a row and gives you the opportunity to delete the file from your file system. To use [`ImageCleaner`](/widgets.image_cleaner.html#ImageCleaner) we must first use `DatasetFormatter().from_toplosses` to get the suggested indices for misclassified images."]}, {"block": 14, "type": "code", "linesLength": 1, "startIndex": 31, "lines": ["ds, idxs = DatasetFormatter().from_toplosses(learn)"]}, {"block": 15, "type": "code", "linesLength": 1, "startIndex": 32, "lines": ["ImageCleaner(ds, idxs, path)"]}]