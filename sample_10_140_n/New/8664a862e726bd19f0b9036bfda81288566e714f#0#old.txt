[{"block": 0, "type": "markdown", "linesLength": 1, "startIndex": 0, "lines": ["# Torch Core"]}, {"block": 1, "type": "markdown", "linesLength": 1, "startIndex": 1, "lines": ["This module contains all the basic functions we need in other modules of the fastai library (split with [`core`](/core.html#core) that contains the ones not requiring pytorch). Its documentation can easily be skipped at a first read, unless you want to know what a given fuction does."]}, {"block": 2, "type": "code", "linesLength": 2, "startIndex": 2, "lines": ["from fastai.gen_doc.nbdoc import *\n", "from fastai.torch_core import * "]}, {"block": 3, "type": "markdown", "linesLength": 1, "startIndex": 4, "lines": ["## Global constants"]}, {"block": 4, "type": "markdown", "linesLength": 1, "startIndex": 5, "lines": ["`AdamW = partial(optim.Adam, betas=(0.9,0.99))` <div style=\"text-align: right\"><a href=\"https://github.com/fastai/fastai/blob/master/fastai/torch_core.py#L43\">[source]</a></div>"]}, {"block": 5, "type": "markdown", "linesLength": 1, "startIndex": 6, "lines": ["`bn_types = (nn.BatchNorm1d, nn.BatchNorm2d, nn.BatchNorm3d)` <div style=\"text-align: right\"><a href=\"https://github.com/fastai/fastai/blob/master/fastai/torch_core.py#L41\">[source]</a></div>"]}, {"block": 6, "type": "markdown", "linesLength": 1, "startIndex": 7, "lines": ["`default_device = torch.device('cuda') if torch.cuda.is_available() else torch.device('cpu')` <div style=\"text-align: right\"><a href=\"https://github.com/fastai/fastai/blob/master/fastai/torch_core.py#L42\">[source]</a></div>"]}, {"block": 7, "type": "markdown", "linesLength": 1, "startIndex": 8, "lines": ["## Functions that operate conversions"]}, {"block": 8, "type": "code", "linesLength": 1, "startIndex": 9, "lines": ["show_doc(flatten_model, full_name='flatten')"]}, {"block": 9, "type": "markdown", "linesLength": 1, "startIndex": 10, "lines": ["Flattens all the layers of `m`. "]}, {"block": 10, "type": "code", "linesLength": 1, "startIndex": 11, "lines": ["show_doc(model2half)"]}, {"block": 11, "type": "code", "linesLength": 1, "startIndex": 12, "lines": ["show_doc(np2model_tensor)"]}, {"block": 12, "type": "code", "linesLength": 1, "startIndex": 13, "lines": ["show_doc(requires_grad, doc_string=False)"]}, {"block": 13, "type": "markdown", "linesLength": 1, "startIndex": 14, "lines": ["If `b` is None, returns the [`requires_grad`](/torch_core.html#requires_grad) state of the first layer of `m`. Otherwise, sets `requires_grad=b` in all children of `m`."]}, {"block": 14, "type": "code", "linesLength": 1, "startIndex": 15, "lines": ["show_doc(tensor)"]}, {"block": 15, "type": "markdown", "linesLength": 1, "startIndex": 16, "lines": ["Ensures `x` is a torch `Tensor`."]}, {"block": 16, "type": "code", "linesLength": 1, "startIndex": 17, "lines": ["show_doc(to_data)"]}, {"block": 17, "type": "code", "linesLength": 1, "startIndex": 18, "lines": ["show_doc(to_detach)"]}, {"block": 18, "type": "code", "linesLength": 1, "startIndex": 19, "lines": ["show_doc(to_device)"]}, {"block": 19, "type": "code", "linesLength": 1, "startIndex": 20, "lines": ["show_doc(to_half, doc_string=False)"]}, {"block": 20, "type": "markdown", "linesLength": 1, "startIndex": 21, "lines": ["Put the input of the batch `b` in half precision."]}, {"block": 21, "type": "code", "linesLength": 1, "startIndex": 22, "lines": ["show_doc(to_np)"]}, {"block": 22, "type": "markdown", "linesLength": 1, "startIndex": 23, "lines": ["Convert `x` to a numpy array."]}, {"block": 23, "type": "markdown", "linesLength": 1, "startIndex": 24, "lines": ["## Functions to deal with model initialization"]}, {"block": 24, "type": "code", "linesLength": 1, "startIndex": 25, "lines": ["show_doc(apply_init)"]}, {"block": 25, "type": "code", "linesLength": 1, "startIndex": 26, "lines": ["show_doc(apply_leaf)"]}, {"block": 26, "type": "code", "linesLength": 1, "startIndex": 27, "lines": ["show_doc(cond_init)"]}, {"block": 27, "type": "code", "linesLength": 1, "startIndex": 28, "lines": ["show_doc(in_channels)"]}, {"block": 28, "type": "markdown", "linesLength": 1, "startIndex": 29, "lines": ["## Functions to get information of a model"]}, {"block": 29, "type": "code", "linesLength": 1, "startIndex": 30, "lines": ["show_doc(children)"]}, {"block": 30, "type": "code", "linesLength": 1, "startIndex": 31, "lines": ["show_doc(first_layer)"]}, {"block": 31, "type": "code", "linesLength": 1, "startIndex": 32, "lines": ["show_doc(last_layer)"]}, {"block": 32, "type": "code", "linesLength": 1, "startIndex": 33, "lines": ["show_doc(num_children)"]}, {"block": 33, "type": "code", "linesLength": 1, "startIndex": 34, "lines": ["show_doc(range_children)"]}, {"block": 34, "type": "code", "linesLength": 1, "startIndex": 35, "lines": ["show_doc(trainable_params)"]}, {"block": 35, "type": "markdown", "linesLength": 1, "startIndex": 36, "lines": ["## Functions to deal with BatchNorm layers"]}, {"block": 36, "type": "code", "linesLength": 1, "startIndex": 37, "lines": ["show_doc(bn2float)"]}, {"block": 37, "type": "code", "linesLength": 1, "startIndex": 38, "lines": ["show_doc(set_bn_eval)"]}, {"block": 38, "type": "code", "linesLength": 1, "startIndex": 39, "lines": ["show_doc(split_bn_bias)"]}, {"block": 39, "type": "markdown", "linesLength": 1, "startIndex": 40, "lines": ["## Other functions"]}, {"block": 40, "type": "code", "linesLength": 1, "startIndex": 41, "lines": ["show_doc(calc_loss)"]}, {"block": 41, "type": "code", "linesLength": 1, "startIndex": 42, "lines": ["show_doc(data_collate)"]}, {"block": 42, "type": "code", "linesLength": 1, "startIndex": 43, "lines": ["show_doc(model_type)"]}, {"block": 43, "type": "code", "linesLength": 1, "startIndex": 44, "lines": ["show_doc(np_address)"]}, {"block": 44, "type": "code", "linesLength": 1, "startIndex": 45, "lines": ["show_doc(split_model, doc_string=False)"]}, {"block": 45, "type": "markdown", "linesLength": 1, "startIndex": 46, "lines": ["Splits the `model` according to the layer in `splits`. If `splits` are layers, the model is split at those (not included) sequentially. If `want_idxs` is True, the corresponding indexes are returned. If `splits` are lists of layers, the model is split according to those."]}, {"block": 46, "type": "code", "linesLength": 1, "startIndex": 47, "lines": ["show_doc(split_model_idx)"]}, {"block": 47, "type": "code", "linesLength": 1, "startIndex": 48, "lines": ["show_doc(trange_of)"]}, {"block": 48, "type": "markdown", "linesLength": 1, "startIndex": 49, "lines": ["Return a tensor from a range that has the same length as `x`."]}, {"block": 49, "type": "markdown", "linesLength": 1, "startIndex": 50, "lines": ["## Undocumented Methods - Methods moved below this line will intentionally be hidden"]}, {"block": 50, "type": "code", "linesLength": 1, "startIndex": 51, "lines": ["show_doc(tensor__array__)"]}, {"block": 51, "type": "markdown", "linesLength": 1, "startIndex": 52, "lines": ["## New Methods - Please document or move to the undocumented section"]}, {"block": 52, "type": "code", "linesLength": 1, "startIndex": 53, "lines": ["show_doc(init_default)"]}, {"block": 53, "type": "markdown", "linesLength": 0, "startIndex": 54, "lines": []}, {"block": 54, "type": "code", "linesLength": 1, "startIndex": 54, "lines": ["show_doc(log_uniform)"]}, {"block": 55, "type": "markdown", "linesLength": 0, "startIndex": 55, "lines": []}, {"block": 56, "type": "code", "linesLength": 1, "startIndex": 55, "lines": ["show_doc(grab_idx)"]}, {"block": 57, "type": "markdown", "linesLength": 0, "startIndex": 56, "lines": []}, {"block": 58, "type": "code", "linesLength": 1, "startIndex": 56, "lines": ["show_doc(uniform_int)"]}, {"block": 59, "type": "markdown", "linesLength": 0, "startIndex": 57, "lines": []}, {"block": 60, "type": "code", "linesLength": 1, "startIndex": 57, "lines": ["show_doc(to_cpu)"]}, {"block": 61, "type": "markdown", "linesLength": 0, "startIndex": 58, "lines": []}, {"block": 62, "type": "code", "linesLength": 1, "startIndex": 58, "lines": ["show_doc(logit)"]}, {"block": 63, "type": "markdown", "linesLength": 0, "startIndex": 59, "lines": []}, {"block": 64, "type": "code", "linesLength": 1, "startIndex": 59, "lines": ["show_doc(FloatItem)"]}, {"block": 65, "type": "markdown", "linesLength": 0, "startIndex": 60, "lines": []}, {"block": 66, "type": "code", "linesLength": 1, "startIndex": 60, "lines": ["show_doc(logit_)"]}, {"block": 67, "type": "markdown", "linesLength": 0, "startIndex": 61, "lines": []}, {"block": 68, "type": "code", "linesLength": 1, "startIndex": 61, "lines": ["show_doc(rand_bool)"]}, {"block": 69, "type": "markdown", "linesLength": 0, "startIndex": 62, "lines": []}, {"block": 70, "type": "code", "linesLength": 1, "startIndex": 62, "lines": ["show_doc(one_param)"]}, {"block": 71, "type": "markdown", "linesLength": 0, "startIndex": 63, "lines": []}, {"block": 72, "type": "code", "linesLength": 1, "startIndex": 63, "lines": ["show_doc(uniform)"]}, {"block": 73, "type": "markdown", "linesLength": 0, "startIndex": 64, "lines": []}]