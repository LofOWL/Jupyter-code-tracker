[{"block": 0, "type": "markdown", "linesLength": 5, "startIndex": 0, "lines": ["<style>div.title-slide {    width: 100%;    display: flex;    flex-direction: row;            /* default value; can be omitted */    flex-wrap: nowrap;              /* default value; can be omitted */    justify-content: space-between;}</style><div class=\"title-slide\">\n", "<span style=\"float:left;\">Licence CC BY-NC-ND</span>\n", "<span>Thierry Parmentelat &amp; Arnaud Legout</span>\n", "<span><img src=\"media/both-logos-small-alpha.png\" style=\"display:inline\" /></span>\n", "</div>"]}, {"block": 1, "type": "markdown", "linesLength": 1, "startIndex": 5, "lines": ["# Bonnes pratiques de pr\u00e9sentation de code"]}, {"block": 2, "type": "markdown", "linesLength": 1, "startIndex": 6, "lines": ["## Compl\u00e9ment - niveau basique"]}, {"block": 3, "type": "markdown", "linesLength": 1, "startIndex": 7, "lines": ["### La PEP 8"]}, {"block": 4, "type": "markdown", "linesLength": 7, "startIndex": 8, "lines": ["On trouve [dans la PEP 8 (en anglais)](http://legacy.python.org/dev/peps/pep-0008/) les conventions de codage qui s'appliquent \u00e0 toute la biblioth\u00e8que standard, et qui sont certainement un bon point de d\u00e9part pour vous aider \u00e0 trouver le style de pr\u00e9sentation qui vous convient.\n", "\n", "Nous vous recommandons en particulier les sections sur\u00a0:\n", "\n", "* [l'indentation](http://legacy.python.org/dev/peps/pep-0008/#code-lay-out)\u00a0;\n", "* [les espaces](http://legacy.python.org/dev/peps/pep-0008/#whitespace-in-expressions-and-statements)\u00a0;\n", "* [les commentaires](http://legacy.python.org/dev/peps/pep-0008/#comments)."]}, {"block": 5, "type": "markdown", "linesLength": 1, "startIndex": 15, "lines": ["### Un peu de lecture\u00a0: le module `pprint`"]}, {"block": 6, "type": "markdown", "linesLength": 9, "startIndex": 16, "lines": ["Voici par exemple le code du module `pprint` (comme PrettyPrint) de la bibloth\u00e8que standard qui permet d'imprimer des donn\u00e9es.\n", "\n", "La fonction du module - le pretty printing - est \u00e9videmment accessoire ici, mais vous pouvez y voir illustr\u00e9\u00a0:\n", "\n", "* le *docstring* pour le module\u00a0: les lignes de 11 \u00e0 35\u00a0;\n", "* les indentations, comme nous l'avons d\u00e9j\u00e0 mentionn\u00e9 sont \u00e0 4 espaces, et sans tabulation\u00a0;\n", "* l'utilisation des espaces, notamment autour des affectations et op\u00e9rateurs, des d\u00e9finitions de fonction, des appels de fonctions\u00a0;\n", "* les lignes qui restent dans une largeur \"raisonnable\" (79 caract\u00e8res)\u00a0;\n", "* vous pouvez regarder notamment la fa\u00e7on de couper les lignes pour respecter cette limite en largeur."]}, {"block": 7, "type": "code", "linesLength": 3, "startIndex": 25, "lines": ["from modtools import show_module_html\n", "import pprint\n", "show_module_html(pprint, lineno_width=3)"]}, {"block": 8, "type": "markdown", "linesLength": 1, "startIndex": 28, "lines": ["### Espaces"]}, {"block": 9, "type": "markdown", "linesLength": 1, "startIndex": 29, "lines": ["Comme vous pouvez le voir dans `pprint.py`, les r\u00e8gles principales concernant les espaces sont les suivantes\u00a0:"]}, {"block": 10, "type": "markdown", "linesLength": 18, "startIndex": 30, "lines": ["* S'agissant des **affectations** et **op\u00e9rateurs**, on fera\u00a0:\n", "```python\n", "    x = y + z\n", "```\n", "  Et non pas\u00a0:\n", "```python\n", "  x=y+z      # pas d'espaces\n", "```\n", "  Ni\u00a0:\n", "```python\n", "  x = y+z    # pas d'espaces autour du +\n", "```\n", "  Ni encore\u00a0:\n", "```python\n", "  x=y + z    # pas d'espace autour du =\n", "```\n", "\n", "L'id\u00e9e \u00e9tant d'a\u00e9rer de mani\u00e8re homog\u00e8ne pour faciliter la lecture."]}, {"block": 11, "type": "markdown", "linesLength": 12, "startIndex": 48, "lines": ["* On **d\u00e9clare une fonction** comme ceci\u00a0:\n", "```python\n", "    def foo(x, y, z):\n", "```\n", "  Et non pas comme ceci\u00a0:\n", "```python\n", "  def foo (x, y, z):    # une espace en trop avant la parenth\u00e8se ouvrante\n", "```\n", "  Ni surtout pas comme ceci\u00a0:\n", "```python\n", "  def foo(x,y,z):       # pas d'espace entre les param\u00e8tres\n", "```"]}, {"block": 12, "type": "markdown", "linesLength": 12, "startIndex": 60, "lines": ["* La m\u00eame r\u00e8gle s'applique naturellement aux **appels de fonction**\u00a0:\n", "```python\n", "    foo(x, y, z)\n", "```\n", "  Et non pas\u00a0:\n", "```python\n", "  foo (x, y, z)    # une espace en trop avant la parenth\u00e8se ouvrante\n", "```\n", "  Ni\u00a0:\n", "```python\n", "  foo(x,y,z)       # pas d'espace entre les param\u00e8tres\n", "```"]}, {"block": 13, "type": "markdown", "linesLength": 1, "startIndex": 72, "lines": ["Il est important de noter qu'il s'agit ici de **r\u00e8gles d'usage** et non pas de r\u00e8gles syntaxiques\u00a0; tous les exemples barr\u00e9s ci-dessus sont en fait **syntaxiquement corrects**, l'interpr\u00e9teur les accepterait sans souci\u00a0; mais ces r\u00e8gles sont **tr\u00e8s largement adopt\u00e9es**, et obligatoires pour int\u00e9grer du code dans la biblioth\u00e8que standard."]}, {"block": 14, "type": "markdown", "linesLength": 1, "startIndex": 73, "lines": ["### Coupures de ligne"]}, {"block": 15, "type": "markdown", "linesLength": 1, "startIndex": 74, "lines": ["Nous allons \u00e0 pr\u00e9sent zoomer dans ce module pour voir quelques exemples de coupure de ligne. Par contraste avec ce qui pr\u00e9c\u00e8de, il s'agit cette fois surtout de **r\u00e8gles syntaxiques**, qui peuvent rendre un code non valide si elles ne sont pas suivies."]}, {"block": 16, "type": "markdown", "linesLength": 1, "startIndex": 75, "lines": ["##### Coupure de ligne sans *backslash* (\\\\)"]}, {"block": 17, "type": "code", "linesLength": 4, "startIndex": 76, "lines": ["show_module_html(pprint,\n", "                 beg=\"def pprint\",\n", "                 end=\"def pformat\",\n", "                 lineno_width=3)"]}, {"block": 18, "type": "markdown", "linesLength": 5, "startIndex": 80, "lines": ["La fonction `pprint` (ligne ~47) est une commodit\u00e9 (qui cr\u00e9e une instance de `PrettyPrinter`, sur lequel on envoie la m\u00e9thode `pprint`).\n", "\n", "Vous voyez ici qu'il n'est **pas n\u00e9cessaire** d'ins\u00e9rer un *backslash* (`\\`) \u00e0 la fin des lignes 50 et 51, car il y a une parenth\u00e8se ouvrante qui n'est pas ferm\u00e9e \u00e0 ce stade.\n", "\n", "De mani\u00e8re g\u00e9n\u00e9rale, lorsqu'une parenth\u00e8se ouvrante `(` - idem avec les crochets `[` et accolades `{` - n'est pas ferm\u00e9e sur la m\u00eame ligne, l'interpr\u00e9teur suppose qu'elle sera ferm\u00e9e plus loin et n'impose pas de *backslash*."]}, {"block": 19, "type": "markdown", "linesLength": 20, "startIndex": 85, "lines": ["Ainsi par exemple on peut \u00e9crire sans *backslash*\u00a0:\n", "\n", "```python\n", "valeurs = [\n", "    1,\n", "    2,\n", "    3,\n", "    5,\n", "    7,\n", "]\n", "```\n", "\n", "Ou encore\u00a0:\n", "\n", "```python\n", "x = un_nom_de_fonction_tres_tres_long(\n", "        argument1, argument2,\n", "        argument3, argument4,\n", "    )\n", "```"]}, {"block": 20, "type": "markdown", "linesLength": 7, "startIndex": 105, "lines": ["\u00c0 titre de rappel, signalons aussi les cha\u00eenes de caract\u00e8res \u00e0 base de `\"\"\"` ou `'''` qui permettent elles aussi d'utiliser pluseurs lignes cons\u00e9cutives sans *backslash*, comme\u00a0:\n", "\n", "```python\n", "texte = \"\"\"Les sanglots longs\n", "Des violons\n", "De l'automne\"\"\"\n", "```"]}, {"block": 21, "type": "markdown", "linesLength": 1, "startIndex": 112, "lines": ["##### Coupure de ligne avec *backslash* (`\\`)"]}, {"block": 22, "type": "markdown", "linesLength": 1, "startIndex": 113, "lines": ["Par contre, il est des cas o\u00f9 le backslash est n\u00e9cessaire\u00a0:"]}, {"block": 23, "type": "code", "linesLength": 4, "startIndex": 114, "lines": ["show_module_html(pprint,\n", "                 beg=\"components), readable, recursive\",\n", "                 end=\"elif len(object) \",\n", "                 lineno_width=3)"]}, {"block": 24, "type": "markdown", "linesLength": 1, "startIndex": 118, "lines": ["Dans ce fragment au contraire, vous voyez en ligne 522 qu'**il a fallu cette fois** ins\u00e9rer un *backslash* `\\` comme caract\u00e8re de continuation pour que l'instruction puisse se poursuivre en ligne 523."]}, {"block": 25, "type": "markdown", "linesLength": 1, "startIndex": 119, "lines": ["##### Coupures de lignes - \u00e9pilogue"]}, {"block": 26, "type": "markdown", "linesLength": 1, "startIndex": 120, "lines": ["Dans tous le cas o\u00f9 une instruction est r\u00e9partie sur plusieurs lignes, c'est naturellement l'indentation de **la premi\u00e8re ligne** qui est significative pour savoir \u00e0 quel bloc rattacher cette instruction."]}, {"block": 27, "type": "markdown", "linesLength": 1, "startIndex": 121, "lines": ["Notez bien enfin qu'on peut toujours mettre un *backslash* m\u00eame lorsque ce n'est pas n\u00e9cessaire, mais on \u00e9vite cette pratique en r\u00e8gle g\u00e9n\u00e9rale car les *backslash* nuisent \u00e0 la lisibilit\u00e9."]}, {"block": 28, "type": "markdown", "linesLength": 1, "startIndex": 122, "lines": ["## Compl\u00e9ment - niveau interm\u00e9diaire"]}, {"block": 29, "type": "markdown", "linesLength": 10, "startIndex": 123, "lines": ["### Outils li\u00e9s \u00e0 PEP 8\n", "\n", "Il existe plusieurs outils li\u00e9s \u00e0 la PEP 8, pour v\u00e9rifier si votre code est conforme, ou m\u00eame le modifier pour qu'il le devienne.\n", "\n", "Ce qui nous donne un excellent pr\u00e9texte pour parler un peu de https://pypi.python.org, qui est la plateforme qui distribue les logiciels disponibles via l'outil `pip3`.\n", "\n", "Je vous signale notamment\u00a0:\n", "\n", "* https://pypi.python.org/pypi/pep8/ pour v\u00e9rifier\u00a0;\n", "* https://pypi.python.org/pypi/autopep8/ pour modifier automatiquement votre code et le rendre conforme."]}, {"block": 30, "type": "markdown", "linesLength": 1, "startIndex": 133, "lines": ["### Les deux-points '`:`'"]}, {"block": 31, "type": "markdown", "linesLength": 1, "startIndex": 134, "lines": ["Dans un autre registre enti\u00e8rement, vous pouvez [vous reporter \u00e0 ce lien](https://docs.python.org/3/faq/design.html#why-are-colons-required-for-the-if-while-def-class-statements) si vous \u00eates int\u00e9ress\u00e9 par la question de savoir pourquoi on a choisi un d\u00e9limiteur (le caract\u00e8re deux-points `:`) pour terminer les instructions comme `if`, `for` et `def`."]}]