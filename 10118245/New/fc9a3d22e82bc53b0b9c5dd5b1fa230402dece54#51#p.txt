[{"block": 0, "type": "markdown", "linesLength": 1, "startIndex": 0, "lines": ["<span style=\"float:left;\">Licence CC BY-NC-ND</span><span style=\"float:right;\">Thierry Parmentelat &amp; Arnaud Legout,<img src=\"media/inria-25.png\" style=\"display:inline\"></span><br/>"]}, {"block": 1, "type": "heading", "linesLength": 1, "startIndex": 1, "lines": ["Les diff\u00e9rentes copies"]}, {"block": 2, "type": "heading", "linesLength": 1, "startIndex": 2, "lines": ["Compl\u00e9ment - niveau basique"]}, {"block": 3, "type": "heading", "linesLength": 1, "startIndex": 3, "lines": ["Deux types de copie"]}, {"block": 4, "type": "markdown", "linesLength": 3, "startIndex": 4, "lines": ["Pour r\u00e9sumer les deux grands types de copie que l'on a vues dans la vid\u00e9o: \n", " * La *shallow copy* - de l'anglais *shallow* qui signifie superficiel\n", " * La *deep copy* - de *deep* qui signifie profond"]}, {"block": 5, "type": "heading", "linesLength": 1, "startIndex": 7, "lines": ["Le module `copy`"]}, {"block": 6, "type": "markdown", "linesLength": 3, "startIndex": 8, "lines": ["Pour r\u00e9aliser une copie, la m\u00e9thode la plus simple, en ceci qu'elle fonctionne avec tous les types de mani\u00e8re identique, consiste \u00e0 utiliser [le module standard `copy`](https://docs.python.org/2/library/copy.html), et notamment\n", " * `copy.copy` pour une copie superficielle\n", " * `copy.deepcopy` pour une copie en profondeur"]}, {"block": 7, "type": "heading", "linesLength": 1, "startIndex": 11, "lines": ["Un exemple"]}, {"block": 8, "type": "heading", "linesLength": 1, "startIndex": 12, "lines": ["Compl\u00e9ment - niveau interm\u00e9diaire"]}, {"block": 9, "type": "heading", "linesLength": 1, "startIndex": 13, "lines": ["Objets *\u00e9gaux* au sens logique"]}, {"block": 10, "type": "markdown", "linesLength": 1, "startIndex": 14, "lines": ["Bien s\u00fbr ces trois objets se ressemblent si on fait une comparaison *logique*"]}, {"block": 11, "type": "heading", "linesLength": 1, "startIndex": 15, "lines": ["Inspectons les objets de premier niveau"]}, {"block": 12, "type": "markdown", "linesLength": 1, "startIndex": 16, "lines": ["Mais par contre si on compare **l'identit\u00e9** des objets de premier niveau, on voit que `source` et `shallow_copy` partagent leurs objets:"]}, {"block": 13, "type": "markdown", "linesLength": 1, "startIndex": 17, "lines": ["Alors que naturellement ce **n'est pas le cas** avec la copie en profondeur"]}, {"block": 14, "type": "markdown", "linesLength": 1, "startIndex": 18, "lines": ["On remarque  tout de suite que les trois derniers objets n'ont pas \u00e9t\u00e9 dupliqu\u00e9s comme on aurait pu s'y attendre; cela est d\u00fb, ici encore, \u00e0 l'optimisation qui est mise en place dans python pour impl\u00e9menter les types immuables comme des singletons lorsque c'est possible. Cela a \u00e9t\u00e9 vu en d\u00e9tail dans le compl\u00e9ment consacr\u00e9 \u00e0 l'op\u00e9rateur `is`."]}, {"block": 15, "type": "heading", "linesLength": 1, "startIndex": 19, "lines": ["On modifie la source"]}, {"block": 16, "type": "markdown", "linesLength": 1, "startIndex": 20, "lines": ["Il doit \u00eatre clair \u00e0 pr\u00e9sent que, pr\u00e9cis\u00e9ment parce que `deep_copy` est une copie en profondeur, on peut modifier `source` sans impacter du tout `deep_copy`."]}, {"block": 17, "type": "markdown", "linesLength": 1, "startIndex": 21, "lines": ["S'agissant de `shallow_copy`, par contre, seuls les \u00e9l\u00e9ments de premier niveau ont \u00e9t\u00e9 copi\u00e9s. Aussi si on fait une modification par exemple **\u00e0 l'int\u00e9rieur** de la liste qui est le premier fils de `source`, cela sera **r\u00e9percut\u00e9** dans `shallow_copy`"]}, {"block": 18, "type": "markdown", "linesLength": 1, "startIndex": 22, "lines": ["Si par contre on remplace compl\u00e8tement un \u00e9l\u00e9ment de premier niveau dans la source, cela ne sera pas r\u00e9percut\u00e9 dans la copie superficielle"]}, {"block": 19, "type": "heading", "linesLength": 1, "startIndex": 23, "lines": ["Copie et circularit\u00e9"]}, {"block": 20, "type": "markdown", "linesLength": 1, "startIndex": 24, "lines": [" Le module `copy` est semble-t-il capable de copier - m\u00eame en profondeur - des objets contenant des r\u00e9f\u00e9rences circulaires."]}, {"block": 21, "type": "heading", "linesLength": 1, "startIndex": 25, "lines": ["Pour en savoir plus"]}, {"block": 22, "type": "markdown", "linesLength": 7, "startIndex": 26, "lines": ["On peut se reporter \u00e0 [la section sur le module `copy`](https://docs.python.org/2/library/copy.html) dans la documentation python.\n", "\n", "Signalons \u00e9galement [pythontutor.com](http://www.pythontutor.com) qui est un site tr\u00e8s utile pour comprendre comment python impl\u00e9mente les objets, les r\u00e9f\u00e9rences et les partages. \n", "Toutefois `pythontutor.com` ne supporte pas le module `copy` ce qui est un peu dommage.\n", "On peut toutefois exp\u00e9rimenter avec des listes en utilisant le slicing `[:]` pour des copies superficielles.\n", "\n", "<img src=\"media/pt_shallow_copy.png\" />"]}]