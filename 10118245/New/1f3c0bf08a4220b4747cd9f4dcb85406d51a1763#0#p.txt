[{"block": 0, "type": "markdown", "linesLength": 5, "startIndex": 0, "lines": ["<style>div.title-slide {    width: 100%;    display: flex;    flex-direction: row;            /* default value; can be omitted */    flex-wrap: nowrap;              /* default value; can be omitted */    justify-content: space-between;}</style><div class=\"title-slide\">\n", "<span style=\"float:left;\">Licence CC BY-NC-ND</span>\n", "<span>Thierry Parmentelat &amp; Arnaud Legout</span>\n", "<span><img src=\"media/both-logos-small-alpha.png\" style=\"display:inline\" /></span>\n", "</div>"]}, {"block": 1, "type": "markdown", "linesLength": 1, "startIndex": 5, "lines": ["# `asyncio`  - un exemple un peu plus r\u00e9aliste"]}, {"block": 2, "type": "markdown", "linesLength": 1, "startIndex": 6, "lines": ["## Compl\u00e9ment - niveau avanc\u00e9"]}, {"block": 3, "type": "markdown", "linesLength": 1, "startIndex": 7, "lines": ["Pour des raisons techniques, il n'est pas possible de mettre en ligne un notebook pour les activit\u00e9s li\u00e9es au r\u00e9seau, qui sont clairement dans le coeur de cible de la librairie - souvenez-vous que ce paradigme de programmation a \u00e9t\u00e9 d\u00e9velopp\u00e9 au d\u00e9part par les projets comme tornado, qui se pr\u00e9occupe de services Web."]}, {"block": 4, "type": "markdown", "linesLength": 3, "startIndex": 8, "lines": ["Aussi, pour illustrer les possibilit\u00e9s offertes par `asyncio` sur un exemple un peu plus significatif que ceux qui utilisent `asyncio.sleep`, nous allons \u00e9crire le d\u00e9but d'une petite architecture de jeu. \n", "\n", "Il s'agit pour nous principalement d'illustrer les capacit\u00e9s de `asyncio` en termes de gestion de sous-processus, car c'est quelque chose qu'on peut d\u00e9ployer dans le contexte des notebooks."]}, {"block": 5, "type": "markdown", "linesLength": 1, "startIndex": 11, "lines": ["Nous allons proc\u00e9der en deux temps. Dans ce premier notebook nous allons \u00e9crire un petit programme python qui s'appelle `players.py`. C'est une brique de base dans notre architecture, dans le second notebook on \u00e9crira un programme qui lance (sous la forme de sous-processes) plusieurs instances de `players.py`."]}, {"block": 6, "type": "markdown", "linesLength": 1, "startIndex": 12, "lines": ["### Le programme `players.py`"]}, {"block": 7, "type": "markdown", "linesLength": 9, "startIndex": 13, "lines": ["Mais dans l'imm\u00e9diat, voyons ce que fait `players.py`. On veut mod\u00e9liser le comportement de plusieurs joueurs. \n", "\n", "Chaque joueur a un comportement hyper basique, il \u00e9met simplement \u00e0 des intervalles al\u00e9atoires un \u00e9v\u00e9nement du type \n", "\n", "> je suis le joueur John et je vais dans la direction Nord\n", "\n", "Chaque joueur a un nom, et une fr\u00e9quence moyenne, et un nombre de cycles.\n", "\n", "Par ailleurs pour \u00eatre un peu vraisemblable, il y a quatre directions `N`, `S`, `E` et `W`, mais que l'on n'utilisera pas vraiment dans la suite."]}, {"block": 8, "type": "markdown", "linesLength": 1, "startIndex": 22, "lines": ["<a href=\"data/players.py\">Voyez ici le code de `players.py`</a>"]}, {"block": 9, "type": "markdown", "linesLength": 1, "startIndex": 23, "lines": ["Comme vous le voyez, dans ce premier exemple nous n'utilisons \u00e0 nouveau que `asyncio.sleep` pour mod\u00e9liser chaque joueur, dont la logique peut \u00eatre illustr\u00e9e simplement comme ceci\u00a0:"]}, {"block": 10, "type": "markdown", "linesLength": 1, "startIndex": 24, "lines": ["![](media/player.png)"]}, {"block": 11, "type": "markdown", "linesLength": 1, "startIndex": 25, "lines": ["Pour \u00e9viter de nous noyer dans des configurations compliqu\u00e9es, on a embarqu\u00e9 dans `players` plusieurs configurations pr\u00e9d\u00e9finies, mais dans tous les cas chacune de ces configurations cr\u00e9e deux joueurs."]}, {"block": 12, "type": "markdown", "linesLength": 1, "startIndex": 26, "lines": ["la logique des deux joueurs est simplement assembl\u00e9e par `asyncio.gather`, ce qui fait que la sortie de `players.py` ressemble toujours \u00e0 ceci\u00a0: "]}, {"block": 13, "type": "markdown", "linesLength": 1, "startIndex": 27, "lines": ["![](media/players.png)"]}, {"block": 14, "type": "code", "linesLength": 3, "startIndex": 28, "lines": ["# si je lance un sous-processus \n", "# depuis le notebook\n", "!data/players.py"]}, {"block": 15, "type": "code", "linesLength": 2, "startIndex": 31, "lines": ["# ou une autre configuration\n", "!data/players.py 2"]}]