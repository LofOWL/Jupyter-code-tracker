[{"block": 0, "type": "markdown", "linesLength": 1, "startIndex": 0, "lines": ["<span style=\"float:left;\">Licence CC BY-NC-ND</span><span style=\"float:right;\">Thierry Parmentelat &amp; Arnaud Legout&nbsp;<img src=\"media/inria-25.png\" style=\"display:inline\"></span><br/>"]}, {"block": 1, "type": "markdown", "linesLength": 1, "startIndex": 1, "lines": ["# Un pi\u00e8ge courant"]}, {"block": 2, "type": "markdown", "linesLength": 1, "startIndex": 2, "lines": ["## Compl\u00e9ment - niveau basique"]}, {"block": 3, "type": "markdown", "linesLength": 1, "startIndex": 3, "lines": ["### N'utilisez pas d'objet mutable pour les valeurs par d\u00e9faut"]}, {"block": 4, "type": "markdown", "linesLength": 3, "startIndex": 4, "lines": ["En python il existe un pi\u00e8ge dans lequel il est tr\u00e8s facile de tomber. Aussi si vous voulez aller \u00e0 l'essentiel: **n'utilisez pas d'objet mutable pour les valeurs par d\u00e9faut**.", "", "Si vous avez besoin d'\u00e9crire une fonction qui prend en argument par d\u00e9faut une liste ou un dictionnaire vide, voici comment faire"]}, {"block": 5, "type": "markdown", "linesLength": 1, "startIndex": 7, "lines": ["## Compl\u00e9ment - niveau interm\u00e9diaire"]}, {"block": 6, "type": "markdown", "linesLength": 1, "startIndex": 8, "lines": ["### Que se passe-t-il si on le fait ?"]}, {"block": 7, "type": "markdown", "linesLength": 3, "startIndex": 9, "lines": ["Pour exhiber l'exemple le plus simple possible, prenons le cas d'une fonction qui calcule une valeur - ici un entier al\u00e9atoire entre 0 et 10 -, et l'ajoute \u00e0 une liste pass\u00e9e par l'appelant. ", "", "Et pour rendre la vie de l'appelant plus facile, on se dit qu'il peut \u00eatre utile de faire en sorte que si l'appelant n'a pas de liste sous la main, on va cr\u00e9er pour lui une liste vide. Et pour \u00e7a on fait"]}, {"block": 8, "type": "markdown", "linesLength": 1, "startIndex": 12, "lines": ["Si on appelle cette fonction une premi\u00e8re fois, tout semble bien aller"]}, {"block": 9, "type": "markdown", "linesLength": 1, "startIndex": 13, "lines": ["Sauf que, si on appelle la fonction une deuxi\u00e8me fois, on a une surprise"]}, {"block": 10, "type": "markdown", "linesLength": 1, "startIndex": 14, "lines": ["### Pourquoi ?"]}, {"block": 11, "type": "markdown", "linesLength": 5, "startIndex": 15, "lines": ["Le probl\u00e8me ici est qu'une valeur par d\u00e9faut - ici l'expression `[]` - est \u00e9valu\u00e9e **une fois** au moment de la **d\u00e9finition** de la fonction. ", "", "Toutes les fois o\u00f9 la fonction est appel\u00e9e avec cet argument manquant, on va utiliser le m\u00eame objet, qui la premi\u00e8re fois est bien une liste vide, mais qui se fait modifier par le premier appel. ", "", "Si bien que la deuxi\u00e8me fois on r\u00e9utilise la m\u00eame liste **qui n'est plus vide**. Pour aller plus loin, vous pouvez regarder la documentation python sur [ce probl\u00e8me](https://docs.python.org/2/faq/programming.html#why-are-default-values-shared-between-objects)."]}]